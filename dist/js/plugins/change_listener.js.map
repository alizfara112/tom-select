{"version":3,"file":"change_listener.js","sources":["../../../src/defaults.ts","../../../src/utils.ts","../../../src/settings.ts","../../../src/plugins/change_listener/plugin.ts"],"sourcesContent":["\nexport default {\n\toptions: [],\n\toptgroups: [],\n\n\tplugins: [],\n\tdelimiter: ',',\n\tsplitOn: null, // regexp or string for splitting up values from a paste command\n\tpersist: true,\n\tdiacritics: true,\n\tcreate: null,\n\tcreateOnBlur: false,\n\tcreateFilter: null,\n\thighlight: true,\n\topenOnFocus: true,\n\tmaxOptions: 50,\n\tmaxItems: null,\n\thideSelected: null,\n\tduplicates: false,\n\taddPrecedence: false,\n\tselectOnTab: false,\n\tpreload: null,\n\tallowEmptyOption: false,\n\tcloseAfterSelect: false,\n\n\tscrollDuration: 60,\n\tloadThrottle: 300,\n\tloadingClass: 'loading',\n\n\tdataAttr: null, //'data-data',\n\toptgroupField: 'optgroup',\n\tvalueField: 'value',\n\tlabelField: 'text',\n\tdisabledField: 'disabled',\n\toptgroupLabelField: 'label',\n\toptgroupValueField: 'value',\n\tlockOptgroupOrder: false,\n\n\tsortField: '$order',\n\tsearchField: ['text'],\n\tsearchConjunction: 'and',\n\n\tmode: null,\n\twrapperClass: 'ts-control',\n\tinputClass: 'ts-input',\n\tdropdownClass: 'ts-dropdown',\n\tdropdownContentClass: 'ts-dropdown-content',\n\titemClass: 'item',\n\toptionClass: 'option',\n\n\tdropdownParent: null,\n\tcontrolInput: null,\n\n\tcopyClassesToDropdown: true,\n\n\t/*\n\tload                 : null, // function(query, callback) { ... }\n\tscore                : null, // function(search) { ... }\n\tonInitialize         : null, // function() { ... }\n\tonChange             : null, // function(value) { ... }\n\tonItemAdd            : null, // function(value, $item) { ... }\n\tonItemRemove         : null, // function(value) { ... }\n\tonClear              : null, // function() { ... }\n\tonOptionAdd          : null, // function(value, data) { ... }\n\tonOptionRemove       : null, // function(value) { ... }\n\tonOptionClear        : null, // function() { ... }\n\tonOptionGroupAdd     : null, // function(id, data) { ... }\n\tonOptionGroupRemove  : null, // function(id) { ... }\n\tonOptionGroupClear   : null, // function() { ... }\n\tonDropdownOpen       : null, // function(dropdown) { ... }\n\tonDropdownClose      : null, // function(dropdown) { ... }\n\tonType               : null, // function(str) { ... }\n\tonDelete             : null, // function(values) { ... }\n\t*/\n\n\trender: {\n\t\t/*\n\t\titem: null,\n\t\toptgroup: null,\n\t\toptgroup_header: null,\n\t\toption: null,\n\t\toption_create: null\n\t\t*/\n\t}\n};\n","\nimport TomSelect from './tom-select';\n\n/**\n * Converts a scalar to its best string representation\n * for hash keys and HTML attribute values.\n *\n * Transformations:\n *   'str'     -> 'str'\n *   null      -> ''\n *   undefined -> ''\n *   true      -> '1'\n *   false     -> '0'\n *   0         -> '0'\n *   1         -> '1'\n *\n */\nexport function hash_key(value:string):string|null {\n\tif (typeof value === 'undefined' || value === null) return null;\n\tif (typeof value === 'boolean') return value ? '1' : '0';\n\treturn value + '';\n};\n\n/**\n * Escapes a string for use within HTML.\n *\n */\nexport function escape_html(str:string):string {\n\treturn (str + '')\n\t\t.replace(/&/g, '&amp;')\n\t\t.replace(/</g, '&lt;')\n\t\t.replace(/>/g, '&gt;')\n\t\t.replace(/\"/g, '&quot;');\n};\n\n\n/**\n * Debounce the user provided load function\n *\n */\nexport function loadDebounce(fn,delay){\n\tvar timeout;\n\treturn function(this:TomSelect, value:string,callback) {\n\t\tvar self = this;\n\n\t\tif( timeout ){\n\t\t\tself.loading = Math.max(self.loading - 1, 0);\n\t\t}\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(function() {\n\t\t\ttimeout = null;\n\t\t\tself.loadedSearches[value] = true;\n\t\t\tfn.call(self, value, callback);\n\n\t\t}, delay);\n\t};\n}\n\n\n/**\n * Debounce all fired events types listed in `types`\n * while executing the provided `fn`.\n *\n */\nexport function debounce_events( self:TomSelect, types:string[], fn:() => void ) {\n\tvar type;\n\tvar trigger = self.trigger;\n\tvar event_args = {};\n\n\t// override trigger method\n\tself.trigger = function(){\n\t\tvar type = arguments[0];\n\t\tif (types.indexOf(type) !== -1) {\n\t\t\tevent_args[type] = arguments;\n\t\t} else {\n\t\t\treturn trigger.apply(self, arguments);\n\t\t}\n\t};\n\n\t// invoke provided function\n\tfn.apply(self, []);\n\tself.trigger = trigger;\n\n\t// trigger queued events\n\tfor (type in event_args) {\n\t\tif (event_args.hasOwnProperty(type)) {\n\t\t\ttrigger.apply(self, event_args[type]);\n\t\t}\n\t}\n};\n\n\n/**\n * Determines the current selection within a text input control.\n * Returns an object containing:\n *   - start\n *   - length\n *\n */\nexport function getSelection(input:HTMLInputElement):{ start: number; length: number } {\n\treturn {\n\t\tstart\t: input.selectionStart,\n\t\tlength\t: input.selectionEnd - input.selectionStart,\n\t};\n};\n\n\n/**\n * Prevent default\n *\n */\nexport function preventDefault(evt?:Event, stop:boolean=false):void{\n\tif( evt ){\n\t\tevt.preventDefault();\n\t\tif( stop ){\n\t\t\tevt.stopPropagation();\n\t\t}\n\t}\n}\n\n\n/**\n * Prevent default\n *\n */\nexport function addEvent(target:EventTarget, type:string, callback:EventListener, options?:object):void{\n\ttarget.addEventListener(type,callback,options);\n}\n\n\n/**\n * Return true if the requested key is down\n * Will return false if more than one control character is pressed ( when [ctrl+shift+a] != [ctrl+a] )\n * The current evt may not always set ( eg calling advanceSelection() )\n *\n */\nexport function isKeyDown( key_name:string, evt:KeyboardEvent|MouseEvent ){\n\n\tif( !evt ){\n\t\treturn false;\n\t}\n\n\tif( !evt[key_name] ){\n\t\treturn false;\n\t}\n\n\tvar count = (evt.altKey?1:0) + (evt.ctrlKey?1:0) + (evt.shiftKey?1:0) + (evt.metaKey?1:0);\n\n\tif( count === 1 ){\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n","import defaults from './defaults.js';\nimport { hash_key } from './utils';\nimport { TomSettings } from './types/settings';\n\nexport default function getSettings( input:HTMLInputElement, settings_user:TomSettings):TomSettings{\n\tvar settings\t\t\t\t= Object.assign({}, defaults, settings_user);\n\n\tvar attr_data\t\t\t\t= settings.dataAttr;\n\tvar field_label\t\t\t\t= settings.labelField;\n\tvar field_value\t\t\t\t= settings.valueField;\n\tvar field_disabled\t\t\t= settings.disabledField;\n\tvar field_optgroup\t\t\t= settings.optgroupField;\n\tvar field_optgroup_label\t= settings.optgroupLabelField;\n\tvar field_optgroup_value\t= settings.optgroupValueField;\n\n\tvar tag_name\t\t\t\t= input.tagName.toLowerCase();\n\tvar placeholder\t\t\t\t= input.getAttribute('placeholder') || input.getAttribute('data-placeholder');\n\n\tif (!placeholder && !settings.allowEmptyOption) {\n\t\tlet option\t\t= input.querySelector('option[value=\"\"]');\n\t\tif( option ){\n\t\t\tplaceholder = option.textContent;\n\t\t}\n\n\t}\n\n\tvar settings_element\t\t= {\n\t\t\t\t\t\t\t\t\t\tplaceholder\t: placeholder,\n\t\t\t\t\t\t\t\t\t\toptions\t\t: [],\n\t\t\t\t\t\t\t\t\t\toptgroups\t: [],\n\t\t\t\t\t\t\t\t\t\titems\t\t: [],\n\t\t\t\t\t\t\t\t\t\tmaxItems\t: null,\n\t\t\t\t\t\t\t\t\t};\n\n\n\t/**\n\t * Initialize from a <select> element.\n\t *\n\t */\n\tvar init_select = () => {\n\t\tvar i, n, tagName, children;\n\t\tvar options = settings_element.options;\n\t\tvar optionsMap = {};\n\n\t\tvar readData = (el) => {\n\n\t\t\tvar data\t= Object.assign({},el.dataset); // get plain object from DOMStringMap\n\t\t\tvar json\t= attr_data && data[attr_data];\n\n\t\t\tif( typeof json === 'string' && json.length ){\n\t\t\t\tdata = Object.assign(data,JSON.parse(json));\n\t\t\t}\n\n\t\t\treturn data;\n\t\t};\n\n\t\tvar addOption = (option, group?:string) => {\n\n\t\t\tvar value = hash_key(option.value);\n\t\t\tif (!value && !settings.allowEmptyOption) return;\n\n\t\t\t// if the option already exists, it's probably been\n\t\t\t// duplicated in another optgroup. in this case, push\n\t\t\t// the current group to the \"optgroup\" property on the\n\t\t\t// existing option so that it's rendered in both places.\n\t\t\tif (optionsMap.hasOwnProperty(value)) {\n\t\t\t\tif (group) {\n\t\t\t\t\tvar arr = optionsMap[value][field_optgroup];\n\t\t\t\t\tif (!arr) {\n\t\t\t\t\t\toptionsMap[value][field_optgroup] = group;\n\t\t\t\t\t} else if (!Array.isArray(arr)) {\n\t\t\t\t\t\toptionsMap[value][field_optgroup] = [arr, group];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarr.push(group);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar option_data             = readData(option);\n\t\t\toption_data[field_label]    = option_data[field_label] || option.textContent;\n\t\t\toption_data[field_value]    = option_data[field_value] || value;\n\t\t\toption_data[field_disabled] = option_data[field_disabled] || option.disabled;\n\t\t\toption_data[field_optgroup] = option_data[field_optgroup] || group;\n\n\t\t\toptionsMap[value] = option_data;\n\t\t\toptions.push(option_data);\n\n\t\t\tif( option.selected ){\n\t\t\t\tsettings_element.items.push(value);\n\t\t\t}\n\t\t};\n\n\t\tvar addGroup = ( optgroup ) => {\n\t\t\tvar i, n, id, optgroup_data, options;\n\n\t\t\tid = optgroup.getAttribute('label')\n\n\t\t\tif (id) {\n\t\t\t\toptgroup_data\t\t\t\t\t\t\t= readData(optgroup);\n\t\t\t\toptgroup_data[field_optgroup_label]\t\t= id;\n\t\t\t\toptgroup_data[field_optgroup_value]\t\t= id;\n\t\t\t\toptgroup_data[field_disabled]\t\t\t= optgroup.disabled;\n\t\t\t\tsettings_element.optgroups.push(optgroup_data);\n\t\t\t}\n\n\t\t\tvar options = optgroup.children;\n\t\t\tfor (i = 0, n = options.length; i < n; i++) {\n\t\t\t\taddOption(options[i], id);\n\t\t\t}\n\t\t};\n\n\t\tsettings_element.maxItems = input.hasAttribute('multiple') ? null : 1;\n\n\t\tchildren = input.children;\n\t\tfor (i = 0, n = children.length; i < n; i++) {\n\t\t\ttagName = children[i].tagName.toLowerCase();\n\t\t\tif (tagName === 'optgroup') {\n\t\t\t\taddGroup(children[i]);\n\t\t\t} else if (tagName === 'option') {\n\t\t\t\taddOption(children[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\n\t/**\n\t * Initialize from a <input type=\"text\"> element.\n\t *\n\t */\n\tvar init_textbox = () => {\n\t\tvar i, n, values, option;\n\n\t\tvar data_raw = input.getAttribute(attr_data);\n\n\t\tif (!data_raw) {\n\t\t\tvar value = input.value.trim() || '';\n\t\t\tif (!settings.allowEmptyOption && !value.length) return;\n\t\t\tvalues = value.split(settings.delimiter);\n\t\t\tfor (i = 0, n = values.length; i < n; i++) {\n\t\t\t\toption = {};\n\t\t\t\toption[field_label] = values[i];\n\t\t\t\toption[field_value] = values[i];\n\t\t\t\tsettings_element.options.push(option);\n\t\t\t}\n\t\t\tsettings_element.items = values;\n\t\t} else {\n\t\t\tsettings_element.options = JSON.parse(data_raw);\n\t\t\tfor (i = 0, n = settings_element.options.length; i < n; i++) {\n\t\t\t\tsettings_element.items.push(settings_element.options[i][field_value]);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tif (tag_name === 'select') {\n\t\tinit_select();\n\t} else {\n\t\tinit_textbox();\n\t}\n\n\treturn Object.assign( {}, defaults, settings_element, settings_user) as TomSettings;\n};\n","/**\n * Plugin: \"change_listener\" (Tom Select)\n * Copyright (c) contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n */\n\nimport TomSelect from '../../tom-select.js';\nimport getSettings from '../../settings.js';\nimport { TomSettings } from '../../types/settings';\nimport { addEvent } from '../../utils';\n\nTomSelect.define('change_listener',function(options){\n\tvar self\t\t= this;\n\tvar changed\t\t= false;\n\n\taddEvent(self.input,'change',()=>{\n\n\t\t// prevent infinite loops\n\t\tif( changed ){\n\t\t\tchanged = false;\n\t\t\treturn;\n\t\t}\n\n\t\tchanged\t\t\t= true;\n\t\tvar settings\t= getSettings( self.input, {} as TomSettings );\n\n\t\tself.setupOptions(settings.options,settings.optgroups);\n\t\tself.setValue(settings.items);\n\t});\n\n});\n"],"names":["options","optgroups","plugins","delimiter","splitOn","persist","diacritics","create","createOnBlur","createFilter","highlight","openOnFocus","maxOptions","maxItems","hideSelected","duplicates","addPrecedence","selectOnTab","preload","allowEmptyOption","closeAfterSelect","scrollDuration","loadThrottle","loadingClass","dataAttr","optgroupField","valueField","labelField","disabledField","optgroupLabelField","optgroupValueField","lockOptgroupOrder","sortField","searchField","searchConjunction","mode","wrapperClass","inputClass","dropdownClass","dropdownContentClass","itemClass","optionClass","dropdownParent","controlInput","copyClassesToDropdown","render","hash_key","value","addEvent","target","type","callback","addEventListener","getSettings","input","settings_user","settings","Object","assign","defaults","attr_data","field_label","field_value","field_disabled","field_optgroup","field_optgroup_label","field_optgroup_value","tag_name","tagName","toLowerCase","placeholder","getAttribute","option","querySelector","textContent","settings_element","items","init_select","i","n","children","optionsMap","readData","el","data","dataset","json","length","JSON","parse","addOption","group","hasOwnProperty","arr","Array","isArray","push","option_data","disabled","selected","addGroup","optgroup","id","optgroup_data","hasAttribute","init_textbox","values","data_raw","trim","split","TomSelect","define","self","changed","setupOptions","setValue"],"mappings":"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"}