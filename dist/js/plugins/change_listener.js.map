{"version":3,"file":"change_listener.js","sources":["../../../src/defaults.js","../../../src/utils.js","../../../src/settings.js","../../../src/plugins/change_listener/plugin.js"],"sourcesContent":["\nexport default {\n\toptions: [],\n\toptgroups: [],\n\n\tplugins: [],\n\tdelimiter: ',',\n\tsplitOn: null, // regexp or string for splitting up values from a paste command\n\tpersist: true,\n\tdiacritics: true,\n\tcreate: false,\n\tcreateOnBlur: false,\n\tcreateFilter: null,\n\thighlight: true,\n\topenOnFocus: true,\n\tmaxOptions: 50,\n\tmaxItems: null,\n\thideSelected: null,\n\tduplicates: false,\n\taddPrecedence: false,\n\tselectOnTab: false,\n\tpreload: false,\n\tallowEmptyOption: false,\n\tcloseAfterSelect: false,\n\n\tscrollDuration: 60,\n\tloadThrottle: 300,\n\tloadingClass: 'loading',\n\n\tdataAttr: null, //'data-data',\n\toptgroupField: 'optgroup',\n\tvalueField: 'value',\n\tlabelField: 'text',\n\tdisabledField: 'disabled',\n\toptgroupLabelField: 'label',\n\toptgroupValueField: 'value',\n\tlockOptgroupOrder: false,\n\n\tsortField: '$order',\n\tsearchField: ['text'],\n\tsearchConjunction: 'and',\n\n\tmode: null,\n\twrapperClass: 'ts-control',\n\tinputClass: 'ts-input',\n\tdropdownClass: 'ts-dropdown',\n\tdropdownContentClass: 'ts-dropdown-content',\n\titemClass: 'item',\n\toptionClass: 'option',\n\n\tdropdownParent: null,\n\tcontrolInput: null,\n\n\tcopyClassesToDropdown: true,\n\n\t/*\n\tload                 : null, // function(query, callback) { ... }\n\tscore                : null, // function(search) { ... }\n\tonInitialize         : null, // function() { ... }\n\tonChange             : null, // function(value) { ... }\n\tonItemAdd            : null, // function(value, $item) { ... }\n\tonItemRemove         : null, // function(value) { ... }\n\tonClear              : null, // function() { ... }\n\tonOptionAdd          : null, // function(value, data) { ... }\n\tonOptionRemove       : null, // function(value) { ... }\n\tonOptionClear        : null, // function() { ... }\n\tonOptionGroupAdd     : null, // function(id, data) { ... }\n\tonOptionGroupRemove  : null, // function(id) { ... }\n\tonOptionGroupClear   : null, // function() { ... }\n\tonDropdownOpen       : null, // function(dropdown) { ... }\n\tonDropdownClose      : null, // function(dropdown) { ... }\n\tonType               : null, // function(str) { ... }\n\tonDelete             : null, // function(values) { ... }\n\t*/\n\n\trender: {\n\t\t/*\n\t\titem: null,\n\t\toptgroup: null,\n\t\toptgroup_header: null,\n\t\toption: null,\n\t\toption_create: null\n\t\t*/\n\t}\n};\n","/**\n * Determines if the provided value has been defined.\n *\n * @param {mixed} object\n * @returns {boolean}\n */\nexport function isset(object) {\n\treturn typeof object !== 'undefined';\n};\n\n/**\n * Converts a scalar to its best string representation\n * for hash keys and HTML attribute values.\n *\n * Transformations:\n *   'str'     -> 'str'\n *   null      -> ''\n *   undefined -> ''\n *   true      -> '1'\n *   false     -> '0'\n *   0         -> '0'\n *   1         -> '1'\n *\n * @param {string} value\n * @returns {string|null}\n */\nexport function hash_key(value) {\n\tif (typeof value === 'undefined' || value === null) return null;\n\tif (typeof value === 'boolean') return value ? '1' : '0';\n\treturn value + '';\n};\n\n/**\n * Escapes a string for use within HTML.\n *\n * @param {string} str\n * @returns {string}\n */\nexport function escape_html(str) {\n\treturn (str + '')\n\t\t.replace(/&/g, '&amp;')\n\t\t.replace(/</g, '&lt;')\n\t\t.replace(/>/g, '&gt;')\n\t\t.replace(/\"/g, '&quot;');\n};\n\n\n/**\n * Debounce all fired events types listed in `types`\n * while executing the provided `fn`.\n *\n * @param {object} self\n * @param {array} types\n * @param {function} fn\n */\nexport function debounce_events( self, types, fn) {\n\tvar type;\n\tvar trigger = self.trigger;\n\tvar event_args = {};\n\n\t// override trigger method\n\tself.trigger = function() {\n\t\tvar type = arguments[0];\n\t\tif (types.indexOf(type) !== -1) {\n\t\t\tevent_args[type] = arguments;\n\t\t} else {\n\t\t\treturn trigger.apply(self, arguments);\n\t\t}\n\t};\n\n\t// invoke provided function\n\tfn.apply(self, []);\n\tself.trigger = trigger;\n\n\t// trigger queued events\n\tfor (type in event_args) {\n\t\tif (event_args.hasOwnProperty(type)) {\n\t\t\ttrigger.apply(self, event_args[type]);\n\t\t}\n\t}\n};\n\n\n/**\n * Determines the current selection within a text input control.\n * Returns an object containing:\n *   - start\n *   - length\n *\n * @param {object} input\n * @returns {object}\n */\nexport function getSelection(input) {\n\treturn {\n\t\tstart\t: input.selectionStart,\n\t\tlength\t: input.selectionEnd - input.selectionStart,\n\t};\n};\n","import defaults from './defaults.js';\nimport { hash_key } from './utils.js';\n\nexport default function getSettings( input, settings_user){\n\tvar settings\t\t\t\t= Object.assign({}, defaults, settings_user);\n\n\tvar attr_data\t\t\t\t= settings.dataAttr;\n\tvar field_label\t\t\t\t= settings.labelField;\n\tvar field_value\t\t\t\t= settings.valueField;\n\tvar field_disabled\t\t\t= settings.disabledField;\n\tvar field_optgroup\t\t\t= settings.optgroupField;\n\tvar field_optgroup_label\t= settings.optgroupLabelField;\n\tvar field_optgroup_value\t= settings.optgroupValueField;\n\n\tvar tag_name\t\t\t\t= input.tagName.toLowerCase();\n\tvar placeholder\t\t\t\t= input.getAttribute('placeholder') || input.getAttribute('data-placeholder');\n\n\tif (!placeholder && !settings.allowEmptyOption) {\n\t\tlet option\t\t= input.querySelector('option[value=\"\"]');\n\t\tif( option ){\n\t\t\tplaceholder = option.textContent;\n\t\t}\n\n\t}\n\n\tvar settings_element\t\t= {\n\t\t\t\t\t\t\t\t\t\t'placeholder' : placeholder,\n\t\t\t\t\t\t\t\t\t\t'options'     : [],\n\t\t\t\t\t\t\t\t\t\t'optgroups'   : [],\n\t\t\t\t\t\t\t\t\t\t'items'       : []\n\t\t\t\t\t\t\t\t\t};\n\n\n\t/**\n\t * Initialize from a <select> element.\n\t *\n\t */\n\tvar init_select = function() {\n\t\tvar i, n, tagName, children;\n\t\tvar options = settings_element.options;\n\t\tvar optionsMap = {};\n\n\t\tvar readData = function(el) {\n\n\t\t\tvar data\t= Object.assign({},el.dataset); // get plain object from DOMStringMap\n\t\t\tvar json\t= attr_data && data[attr_data];\n\n\t\t\tif( typeof json === 'string' && json.length ){\n\t\t\t\tdata = Object.assign(data,JSON.parse(json));\n\t\t\t}\n\n\t\t\treturn data;\n\t\t};\n\n\t\tvar addOption = function(option, group) {\n\n\t\t\tvar value = hash_key(option.value);\n\t\t\tif (!value && !settings.allowEmptyOption) return;\n\n\t\t\t// if the option already exists, it's probably been\n\t\t\t// duplicated in another optgroup. in this case, push\n\t\t\t// the current group to the \"optgroup\" property on the\n\t\t\t// existing option so that it's rendered in both places.\n\t\t\tif (optionsMap.hasOwnProperty(value)) {\n\t\t\t\tif (group) {\n\t\t\t\t\tvar arr = optionsMap[value][field_optgroup];\n\t\t\t\t\tif (!arr) {\n\t\t\t\t\t\toptionsMap[value][field_optgroup] = group;\n\t\t\t\t\t} else if (!Array.isArray(arr)) {\n\t\t\t\t\t\toptionsMap[value][field_optgroup] = [arr, group];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tarr.push(group);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar option_data             = readData(option);\n\t\t\toption_data[field_label]    = option_data[field_label] || option.textContent;\n\t\t\toption_data[field_value]    = option_data[field_value] || value;\n\t\t\toption_data[field_disabled] = option_data[field_disabled] || option.disabled;\n\t\t\toption_data[field_optgroup] = option_data[field_optgroup] || group;\n\n\t\t\toptionsMap[value] = option_data;\n\t\t\toptions.push(option_data);\n\n\t\t\tif( option.selected ){\n\t\t\t\tsettings_element.items.push(value);\n\t\t\t}\n\t\t};\n\n\t\tvar addGroup = function( optgroup ){\n\t\t\tvar i, n, id, optgroup_data, options;\n\n\t\t\tid = optgroup.getAttribute('label')\n\n\t\t\tif (id) {\n\t\t\t\toptgroup_data\t\t\t\t\t\t\t= readData(optgroup);\n\t\t\t\toptgroup_data[field_optgroup_label]\t\t= id;\n\t\t\t\toptgroup_data[field_optgroup_value]\t\t= id;\n\t\t\t\toptgroup_data[field_disabled]\t\t\t= optgroup.disabled;\n\t\t\t\tsettings_element.optgroups.push(optgroup_data);\n\t\t\t}\n\n\t\t\tvar options = optgroup.children;\n\t\t\tfor (i = 0, n = options.length; i < n; i++) {\n\t\t\t\taddOption(options[i], id);\n\t\t\t}\n\t\t};\n\n\t\tsettings_element.maxItems = input.hasAttribute('multiple') ? null : 1;\n\n\t\tchildren = input.children;\n\t\tfor (i = 0, n = children.length; i < n; i++) {\n\t\t\ttagName = children[i].tagName.toLowerCase();\n\t\t\tif (tagName === 'optgroup') {\n\t\t\t\taddGroup(children[i]);\n\t\t\t} else if (tagName === 'option') {\n\t\t\t\taddOption(children[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\n\t/**\n\t * Initialize from a <input type=\"text\"> element.\n\t *\n\t */\n\tvar init_textbox = function(){\n\t\tvar i, n, values, option;\n\n\t\tvar data_raw = input.getAttribute(attr_data);\n\n\t\tif (!data_raw) {\n\t\t\tvar value = input.value.trim() || '';\n\t\t\tif (!settings.allowEmptyOption && !value.length) return;\n\t\t\tvalues = value.split(settings.delimiter);\n\t\t\tfor (i = 0, n = values.length; i < n; i++) {\n\t\t\t\toption = {};\n\t\t\t\toption[field_label] = values[i];\n\t\t\t\toption[field_value] = values[i];\n\t\t\t\tsettings_element.options.push(option);\n\t\t\t}\n\t\t\tsettings_element.items = values;\n\t\t} else {\n\t\t\tsettings_element.options = JSON.parse(data_raw);\n\t\t\tfor (i = 0, n = settings_element.options.length; i < n; i++) {\n\t\t\t\tsettings_element.items.push(settings_element.options[i][field_value]);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tif (tag_name === 'select') {\n\t\tinit_select();\n\t} else {\n\t\tinit_textbox();\n\t}\n\n\treturn Object.assign( {}, defaults, settings_element, settings_user);\n};\n","/**\n * Plugin: \"change_listener\" (Tom Select)\n * Copyright (c) contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n */\n\nimport TomSelect from '../../tom-select.js';\nimport getSettings from '../../settings.js';\n\nexport default TomSelect.define('change_listener',function(options){\n\tvar self\t\t= this;\n\tvar changed\t\t= false;\n\n\tself.input.addEventListener('change',function(){\n\n\t\t// prevent infinite loops\n\t\tif( changed ){\n\t\t\tchanged = false;\n\t\t\treturn;\n\t\t}\n\n\t\tchanged\t\t\t= true;\n\t\tvar settings\t= getSettings( self.input, {} );\n\n\t\tself.setupOptions(settings.options,settings.optgroups);\n\t\tself.setValue(settings.items);\n\t});\n\n});\n"],"names":["options","optgroups","plugins","delimiter","splitOn","persist","diacritics","create","createOnBlur","createFilter","highlight","openOnFocus","maxOptions","maxItems","hideSelected","duplicates","addPrecedence","selectOnTab","preload","allowEmptyOption","closeAfterSelect","scrollDuration","loadThrottle","loadingClass","dataAttr","optgroupField","valueField","labelField","disabledField","optgroupLabelField","optgroupValueField","lockOptgroupOrder","sortField","searchField","searchConjunction","mode","wrapperClass","inputClass","dropdownClass","dropdownContentClass","itemClass","optionClass","dropdownParent","controlInput","copyClassesToDropdown","render","hash_key","value","getSettings","input","settings_user","settings","Object","assign","defaults","attr_data","field_label","field_value","field_disabled","field_optgroup","field_optgroup_label","field_optgroup_value","tag_name","tagName","toLowerCase","placeholder","getAttribute","option","querySelector","textContent","settings_element","init_select","i","n","children","optionsMap","readData","el","data","dataset","json","length","JSON","parse","addOption","group","hasOwnProperty","arr","Array","isArray","push","option_data","disabled","selected","items","addGroup","optgroup","id","optgroup_data","hasAttribute","init_textbox","values","data_raw","trim","split","TomSelect","define","self","changed","addEventListener","setupOptions","setValue"],"mappings":"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"}