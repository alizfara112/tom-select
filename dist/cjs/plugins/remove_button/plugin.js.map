{"version":3,"file":"plugin.js","sources":["../../../../src/plugins/remove_button/plugin.ts"],"sourcesContent":["/**\n * Plugin: \"remove_button\" (Tom Select)\n * Copyright (c) contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n */\nimport TomSelect from '../../tom-select.js';\nimport { getDom } from '../../vanilla';\nimport { escape_html, preventDefault, addEvent } from '../../utils';\n\nTomSelect.define('remove_button',function(options) {\n\n\toptions = Object.assign({\n\t\t\tlabel     : '&times;',\n\t\t\ttitle     : 'Remove',\n\t\t\tclassName : 'remove',\n\t\t\tappend    : true\n\t\t}, options);\n\n\n\t//options.className = 'remove-single';\n\tvar self\t\t\t= this;\n\n\t// override the render method to add remove button to each item\n\tif( !options.append ){\n\t\treturn;\n\t}\n\n\tvar html = '<a href=\"javascript:void(0)\" class=\"' + options.className + '\" tabindex=\"-1\" title=\"' + escape_html(options.title) + '\">' + options.label + '</a>';\n\n\tself.hook('after','setupTemplates',() => {\n\n\t\tvar orig_render_item = self.settings.render.item;\n\n\t\tself.settings.render.item = function(){\n\n\t\t\tvar rendered = getDom(orig_render_item.apply(self, arguments));\n\n\t\t\tvar close_button = getDom(html);\n\t\t\trendered.appendChild(close_button);\n\n\t\t\taddEvent(close_button,'mousedown',(evt) => {\n\t\t\t\tpreventDefault(evt,true);\n\t\t\t});\n\n\t\t\taddEvent(close_button,'click',(evt) => {\n\n\t\t\t\t// propagating will trigger the dropdown to show for single mode\n\t\t\t\tpreventDefault(evt,true);\n\n\t\t\t\tif (self.isLocked) return;\n\n\t\t\t\tvar value = rendered.dataset.value;\n\t\t\t\tself.removeItem(value);\n\t\t\t\tself.refreshOptions(false);\n\t\t\t});\n\n\t\t\treturn rendered;\n\t\t};\n\n\t});\n\n\n});\n"],"names":["TomSelect","define","options","Object","assign","label","title","className","append","self","html","escape_html","hook","orig_render_item","settings","render","item","rendered","getDom","apply","arguments","close_button","appendChild","addEvent","evt","preventDefault","isLocked","value","dataset","removeItem","refreshOptions"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKAA,SAAS,CAACC,MAAV,CAAiB,eAAjB,EAAiC,UAASC,OAAT,EAAkB;AAElDA,EAAAA,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAc;AACtBC,IAAAA,KAAK,EAAO,SADU;AAEtBC,IAAAA,KAAK,EAAO,QAFU;AAGtBC,IAAAA,SAAS,EAAG,QAHU;AAItBC,IAAAA,MAAM,EAAM;AAJU,GAAd,EAKNN,OALM,CAAV,CAFkD;;AAWlD,MAAIO,IAAI,GAAK,IAAb,CAXkD;;AAclD,MAAI,CAACP,OAAO,CAACM,MAAb,EAAqB;AACpB;AACA;;AAED,MAAIE,IAAI,GAAG,yCAAyCR,OAAO,CAACK,SAAjD,GAA6D,yBAA7D,GAAyFI,iBAAW,CAACT,OAAO,CAACI,KAAT,CAApG,GAAsH,IAAtH,GAA6HJ,OAAO,CAACG,KAArI,GAA6I,MAAxJ;AAEAI,EAAAA,IAAI,CAACG,IAAL,CAAU,OAAV,EAAkB,gBAAlB,EAAmC,MAAM;AAExC,QAAIC,gBAAgB,GAAGJ,IAAI,CAACK,QAAL,CAAcC,MAAd,CAAqBC,IAA5C;;AAEAP,IAAAA,IAAI,CAACK,QAAL,CAAcC,MAAd,CAAqBC,IAArB,GAA4B,YAAU;AAErC,UAAIC,QAAQ,GAAGC,cAAM,CAACL,gBAAgB,CAACM,KAAjB,CAAuBV,IAAvB,EAA6BW,SAA7B,CAAD,CAArB;AAEA,UAAIC,YAAY,GAAGH,cAAM,CAACR,IAAD,CAAzB;AACAO,MAAAA,QAAQ,CAACK,WAAT,CAAqBD,YAArB;AAEAE,MAAAA,cAAQ,CAACF,YAAD,EAAc,WAAd,EAA2BG,GAAD,IAAS;AAC1CC,QAAAA,oBAAc,CAACD,GAAD,EAAK,IAAL,CAAd;AACA,OAFO,CAAR;AAIAD,MAAAA,cAAQ,CAACF,YAAD,EAAc,OAAd,EAAuBG,GAAD,IAAS;AAEtC;AACAC,QAAAA,oBAAc,CAACD,GAAD,EAAK,IAAL,CAAd;AAEA,YAAIf,IAAI,CAACiB,QAAT,EAAmB;AAEnB,YAAIC,KAAK,GAAGV,QAAQ,CAACW,OAAT,CAAiBD,KAA7B;AACAlB,QAAAA,IAAI,CAACoB,UAAL,CAAgBF,KAAhB;AACAlB,QAAAA,IAAI,CAACqB,cAAL,CAAoB,KAApB;AACA,OAVO,CAAR;AAYA,aAAOb,QAAP;AACA,KAxBD;AA0BA,GA9BD;AAiCA,CArDD;;"}