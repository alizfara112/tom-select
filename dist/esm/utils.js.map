{"version":3,"file":"utils.js","sources":["../../src/utils.ts"],"sourcesContent":["\nimport TomSelect from './tom-select';\n\n/**\n * Converts a scalar to its best string representation\n * for hash keys and HTML attribute values.\n *\n * Transformations:\n *   'str'     -> 'str'\n *   null      -> ''\n *   undefined -> ''\n *   true      -> '1'\n *   false     -> '0'\n *   0         -> '0'\n *   1         -> '1'\n *\n */\nexport function hash_key(value:string):string|null {\n\tif (typeof value === 'undefined' || value === null) return null;\n\tif (typeof value === 'boolean') return value ? '1' : '0';\n\treturn value + '';\n};\n\n/**\n * Escapes a string for use within HTML.\n *\n */\nexport function escape_html(str:string):string {\n\treturn (str + '')\n\t\t.replace(/&/g, '&amp;')\n\t\t.replace(/</g, '&lt;')\n\t\t.replace(/>/g, '&gt;')\n\t\t.replace(/\"/g, '&quot;');\n};\n\n\n/**\n * Debounce the user provided load function\n *\n */\nexport function loadDebounce(fn,delay){\n\tvar timeout;\n\tvar self = this;\n\treturn function() {\n\t\tvar args = arguments;\n\t\tif( timeout ){\n\t\t\tthis.loading = Math.max(this.loading - 1, 0);\n\t\t}\n\t\tclearTimeout(timeout);\n\t\ttimeout = setTimeout(function() {\n\t\t\ttimeout = null;\n\t\t\tfn.apply(self, args);\n\n\t\t}, delay);\n\t};\n}\n\n\n/**\n * Debounce all fired events types listed in `types`\n * while executing the provided `fn`.\n *\n */\nexport function debounce_events( self:TomSelect, types:string[], fn:() => void ) {\n\tvar type;\n\tvar trigger = self.trigger;\n\tvar event_args = {};\n\n\t// override trigger method\n\tself.trigger = function(){\n\t\tvar type = arguments[0];\n\t\tif (types.indexOf(type) !== -1) {\n\t\t\tevent_args[type] = arguments;\n\t\t} else {\n\t\t\treturn trigger.apply(self, arguments);\n\t\t}\n\t};\n\n\t// invoke provided function\n\tfn.apply(self, []);\n\tself.trigger = trigger;\n\n\t// trigger queued events\n\tfor (type in event_args) {\n\t\tif (event_args.hasOwnProperty(type)) {\n\t\t\ttrigger.apply(self, event_args[type]);\n\t\t}\n\t}\n};\n\n\n/**\n * Determines the current selection within a text input control.\n * Returns an object containing:\n *   - start\n *   - length\n *\n */\nexport function getSelection(input:HTMLInputElement):{ start: number; length: number } {\n\treturn {\n\t\tstart\t: input.selectionStart,\n\t\tlength\t: input.selectionEnd - input.selectionStart,\n\t};\n};\n\n\n/**\n * Prevent default\n *\n */\nexport function preventDefault(evt?:Event, stop:boolean=false):void{\n\tif( evt ){\n\t\tevt.preventDefault();\n\t\tif( stop ){\n\t\t\tevt.stopPropagation();\n\t\t}\n\t}\n}\n\n\n/**\n * Prevent default\n *\n */\nexport function addEvent(target:EventTarget, type:string, callback:EventListener, options?:object):void{\n\ttarget.addEventListener(type,callback,options);\n}\n\n\n/**\n * Return true if the requested key is down\n * Will return false if more than one control character is pressed ( when [ctrl+shift+a] != [ctrl+a] )\n * The current evt may not always set ( eg calling advanceSelection() )\n *\n */\nexport function isKeyDown( key_name:string, evt:KeyboardEvent|MouseEvent ){\n\n\tif( !evt ){\n\t\treturn false;\n\t}\n\n\tif( !evt[key_name] ){\n\t\treturn false;\n\t}\n\n\tvar count = (evt.altKey?1:0) + (evt.ctrlKey?1:0) + (evt.shiftKey?1:0) + (evt.metaKey?1:0);\n\n\tif( count === 1 ){\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n"],"names":["hash_key","value","escape_html","str","replace","loadDebounce","fn","delay","timeout","self","args","arguments","loading","Math","max","clearTimeout","setTimeout","apply","debounce_events","types","type","trigger","event_args","indexOf","hasOwnProperty","getSelection","input","start","selectionStart","length","selectionEnd","preventDefault","evt","stop","stopPropagation","addEvent","target","callback","options","addEventListener","isKeyDown","key_name","count","altKey","ctrlKey","shiftKey","metaKey"],"mappings":"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"}