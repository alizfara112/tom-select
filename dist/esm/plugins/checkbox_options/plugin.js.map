{"version":3,"file":"plugin.js","sources":["../../../../src/plugins/checkbox_options/plugin.ts"],"sourcesContent":["/**\n * Plugin: \"restore_on_backspace\" (Tom Select)\n * Copyright (c) contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n */\nimport TomSelect from '../../tom-select.js';\nimport { preventDefault, hash_key } from '../../utils';\nimport { getDom } from '../../vanilla';\nimport { TomOption } from '../../types/index';\n\ntype TPluginOptions = {\n\ttext:(option:TomOption)=>string,\n};\n\nTomSelect.define('checkbox_options',function(options:TPluginOptions) {\n\tvar self = this;\n\tvar orig_onOptionSelect = self.onOptionSelect;\n\n\tself.settings.hideSelected = false;\n\n\n\t// update the checkbox for an option\n\tvar UpdateCheckbox = function(option){\n\t\tvar checkbox = option.querySelector('input');\n\t\tif( option.classList.contains('selected') ){\n\t\t\tcheckbox.checked = true;\n\t\t}else{\n\t\t\tcheckbox.checked = false;\n\t\t}\n\t};\n\n\t// add checkbox to option template\n\tself.hook('after','setupTemplates',() => {\n\n\t\tvar orig_render_option = self.settings.render.option;\n\n\t\tself.settings.render.option = function(data){\n\t\t\tvar rendered = getDom(orig_render_option.apply(self, arguments));\n\t\t\tvar checkbox = document.createElement('input');\n\t\t\tcheckbox.addEventListener('click',function(evt){\n\t\t\t\tpreventDefault(evt);\n\t\t\t});\n\n\t\t\tcheckbox.type = 'checkbox';\n\t\t\tvar value = hash_key(data[self.settings.valueField]);\n\n\n\t\t\tif( self.items.indexOf(value) > -1 ){\n\t\t\t\tcheckbox.checked = true;\n\t\t\t}\n\n\t\t\trendered.prepend(checkbox);\n\t\t\treturn rendered;\n\t\t};\n\t});\n\n\t// uncheck when item removed\n\tself.on('item_remove',(value) => {\n\t\tvar option = self.getOption(value);\n\n\t\tif( option ){ // if dropdown hasn't been opened yet, the option won't exist\n\t\t\toption.classList.remove('selected'); // selected class won't be removed yet\n\t\t\tUpdateCheckbox(option);\n\t\t}\n\t});\n\n\n\t// remove items when selected option is clicked\n\tself.hook('instead','onOptionSelect',function( evt:KeyboardEvent, option:HTMLElement ){\n\n\t\tif( option.classList.contains('selected') ){\n\t\t\toption.classList.remove('selected')\n\t\t\tself.removeItem(option.dataset.value);\n\t\t\tself.refreshOptions();\n\t\t\tpreventDefault(evt,true);\n\t\t\treturn;\n        }\n\n\t\treturn orig_onOptionSelect.apply(self, arguments);\n\t});\n\n\n\t// update option checkbox\n\tself.hook('after','onOptionSelect',( evt:KeyboardEvent, option:HTMLElement ) => {\n\t\tUpdateCheckbox(option);\n\t});\n\n});\n"],"names":["TomSelect","define","options","self","orig_onOptionSelect","onOptionSelect","settings","hideSelected","UpdateCheckbox","option","checkbox","querySelector","classList","contains","checked","hook","orig_render_option","render","data","rendered","getDom","apply","arguments","document","createElement","addEventListener","evt","preventDefault","type","value","hash_key","valueField","items","indexOf","prepend","on","getOption","remove","removeItem","dataset","refreshOptions"],"mappings":"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"}